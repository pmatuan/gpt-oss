srun: job 82203 queued and waiting for resources
srun: job 82203 has been allocated resources
parsing args...
loading tiktoken encoding: o200k_harmony
reading submission: submission/output_20b_token_ids.txt
decoding file: submission/output_20b_token_ids.txt
decoded lines: 896 from submission/output_20b_token_ids.txt
reading references: references/output_20b_token_ids.txt
decoding file: references/output_20b_token_ids.txt
decoded lines: 16384 from references/output_20b_token_ids.txt
computing METEOR...
ensuring nltk resources...
nltk resource available: punkt
downloading nltk resource: wordnet
downloaded: wordnet
downloading nltk resource: omw-1.4
downloaded: omw-1.4
aligning by index, items: 896
computing METEOR in parallel with 96 workers...
  0%|          | 0/896 [00:00<?, ?it/s]  0%|          | 1/896 [00:18<4:34:14, 18.38s/it]  0%|          | 2/896 [00:19<2:00:31,  8.09s/it]  1%|          | 7/896 [00:20<25:06,  1.69s/it]    3%|▎         | 26/896 [00:20<04:41,  3.09it/s]  3%|▎         | 31/896 [00:20<03:40,  3.93it/s]  5%|▌         | 48/896 [00:20<01:46,  7.99it/s]  7%|▋         | 65/896 [00:20<01:04, 12.79it/s] 35%|███▌      | 318/896 [00:21<00:05, 115.03it/s] 44%|████▍     | 393/896 [00:21<00:03, 140.71it/s] 50%|████▉     | 447/896 [00:21<00:02, 162.26it/s] 60%|█████▉    | 536/896 [00:21<00:01, 213.89it/s] 64%|██████▍   | 577/896 [00:21<00:01, 217.71it/s] 68%|██████▊   | 613/896 [00:22<00:01, 172.50it/s] 85%|████████▌ | 762/896 [00:22<00:00, 304.50it/s]100%|██████████| 896/896 [00:22<00:00, 39.68it/s] 
meteor	0.515435
computing BERTScore (roberta-large-mnli)...
found local BERTScore model at /nfs/gpu_trainee/final-project/models/bs_model/roberta-large-mnli
loading BERTScore model: /nfs/gpu_trainee/final-project/models/bs_model/roberta-large-mnli...
BERTScore device: GPU (2 device(s))
calculating scores...
computing bert embedding.
BERTScore:   0%|          | 0/896 [00:00<?, ?it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:11<00:35, 11.97s/it][A
 50%|█████     | 2/4 [00:13<00:11,  5.56s/it][A
 75%|███████▌  | 3/4 [00:14<00:03,  3.51s/it][A
100%|██████████| 4/4 [00:15<00:00,  2.53s/it][A100%|██████████| 4/4 [00:15<00:00,  3.78s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|█████     | 1/2 [00:00<00:00,  7.58it/s][A100%|██████████| 2/2 [00:00<00:00, 13.31it/s]
done in 15.31 seconds, 8.36 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  14%|█▍        | 128/896 [00:15<01:31,  8.36it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.06s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.06s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.06s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.03s/it][A100%|██████████| 4/4 [00:04<00:00,  1.04s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.56it/s]
done in 4.21 seconds, 30.42 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  29%|██▊       | 256/896 [00:19<00:43, 14.58it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.06s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.06s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.06s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.01s/it][A100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.42it/s]
done in 4.17 seconds, 30.71 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  43%|████▎     | 384/896 [00:23<00:26, 19.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.06s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.06s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.06s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.04s/it][A100%|██████████| 4/4 [00:04<00:00,  1.05s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.43it/s]
done in 4.24 seconds, 30.22 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  57%|█████▋    | 512/896 [00:27<00:17, 22.41it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.05s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.04s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.04s/it][A
100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A100%|██████████| 4/4 [00:03<00:00,  1.00it/s]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.10it/s]
done in 4.05 seconds, 31.57 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  71%|███████▏  | 640/896 [00:31<00:10, 25.03it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.04s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.04s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.04s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.03s/it][A100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.23it/s]
done in 4.18 seconds, 30.62 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  86%|████████▌ | 768/896 [00:36<00:04, 26.69it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.04s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.04s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.04s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.02s/it][A100%|██████████| 4/4 [00:04<00:00,  1.02s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.10it/s]
BERTScore: 100%|██████████| 896/896 [00:40<00:00, 27.91it/s]BERTScore: 100%|██████████| 896/896 [00:40<00:00, 22.23it/s]
done in 4.15 seconds, 30.83 sentences/sec
bertscore_f1	0.977817
========== 

done.
items	896
meteor	0.515435
bertscore_f1	0.977817
