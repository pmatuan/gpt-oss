srun: job 78730 queued and waiting for resources
srun: job 78730 has been allocated resources
parsing args...
loading tiktoken encoding: o200k_harmony
reading submission: submission/output_20b_token_ids.txt
decoding file: submission/output_20b_token_ids.txt
decoded lines: 896 from submission/output_20b_token_ids.txt
reading references: references/output_20b_token_ids.txt
decoding file: references/output_20b_token_ids.txt
decoded lines: 16384 from references/output_20b_token_ids.txt
computing METEOR...
ensuring nltk resources...
nltk resource available: punkt
downloading nltk resource: wordnet
downloaded: wordnet
downloading nltk resource: omw-1.4
downloaded: omw-1.4
aligning by index, items: 896
computing METEOR in parallel with 96 workers...
  0%|          | 0/896 [00:00<?, ?it/s]  0%|          | 1/896 [00:19<4:52:43, 19.62s/it]  0%|          | 2/896 [00:20<2:07:57,  8.59s/it]  1%|          | 7/896 [00:20<24:43,  1.67s/it]    1%|▏         | 13/896 [00:21<10:57,  1.34it/s]  6%|▌         | 51/896 [00:21<01:46,  7.93it/s] 48%|████▊     | 428/896 [00:21<00:04, 99.16it/s] 60%|██████    | 538/896 [00:21<00:02, 120.24it/s] 69%|██████▉   | 620/896 [00:22<00:01, 138.91it/s] 76%|███████▋  | 685/896 [00:22<00:01, 149.46it/s] 96%|█████████▋| 864/896 [00:22<00:00, 247.54it/s]100%|██████████| 896/896 [00:22<00:00, 39.58it/s] 
meteor	0.518461
computing BERTScore (roberta-large-mnli)...
found local BERTScore model at /nfs/gpu_trainee/final-project/models/bs_model/roberta-large-mnli
loading BERTScore model: /nfs/gpu_trainee/final-project/models/bs_model/roberta-large-mnli...
BERTScore device: GPU (2 device(s))
calculating scores...
computing bert embedding.
BERTScore:   0%|          | 0/896 [00:00<?, ?it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:13<00:40, 13.35s/it][A
 50%|█████     | 2/4 [00:14<00:12,  6.14s/it][A
 75%|███████▌  | 3/4 [00:15<00:03,  3.82s/it][A
100%|██████████| 4/4 [00:16<00:00,  2.73s/it][A100%|██████████| 4/4 [00:16<00:00,  4.14s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|█████     | 1/2 [00:00<00:00,  6.08it/s][A100%|██████████| 2/2 [00:00<00:00, 10.91it/s]
done in 16.80 seconds, 7.62 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  14%|█▍        | 128/896 [00:16<01:40,  7.62it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.06s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.06s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.06s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.01s/it][A100%|██████████| 4/4 [00:04<00:00,  1.02s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.70it/s]
done in 4.18 seconds, 30.66 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  29%|██▊       | 256/896 [00:20<00:46, 13.66it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.06s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.06s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.06s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.02s/it][A100%|██████████| 4/4 [00:04<00:00,  1.04s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.78it/s]
done in 4.22 seconds, 30.36 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  43%|████▎     | 384/896 [00:25<00:28, 18.24it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.05s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.05s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.03s/it][A100%|██████████| 4/4 [00:04<00:00,  1.04s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.76it/s]
done in 4.24 seconds, 30.16 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  57%|█████▋    | 512/896 [00:29<00:17, 21.61it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.04s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.04s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.04s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.02s/it][A100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.36it/s]
done in 4.18 seconds, 30.65 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  71%|███████▏  | 640/896 [00:33<00:10, 24.18it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.04s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.04s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.03s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.00s/it][A100%|██████████| 4/4 [00:04<00:00,  1.01s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.47it/s]
done in 4.13 seconds, 31.02 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  86%|████████▌ | 768/896 [00:37<00:04, 26.14it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.03s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.04s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.04s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.02s/it][A100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.41it/s]
BERTScore: 100%|██████████| 896/896 [00:41<00:00, 27.45it/s]BERTScore: 100%|██████████| 896/896 [00:41<00:00, 21.37it/s]
done in 4.18 seconds, 30.59 sentences/sec
bertscore_f1	0.978082
========== 

done.
items	896
meteor	0.518461
bertscore_f1	0.978082
