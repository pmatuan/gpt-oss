srun: job 81530 queued and waiting for resources
srun: job 81530 has been allocated resources
parsing args...
loading tiktoken encoding: o200k_harmony
reading submission: submission/output_20b_token_ids.txt
decoding file: submission/output_20b_token_ids.txt
decoded lines: 896 from submission/output_20b_token_ids.txt
reading references: references/output_20b_token_ids.txt
decoding file: references/output_20b_token_ids.txt
decoded lines: 16384 from references/output_20b_token_ids.txt
computing METEOR...
ensuring nltk resources...
nltk resource available: punkt
downloading nltk resource: wordnet
downloaded: wordnet
downloading nltk resource: omw-1.4
downloaded: omw-1.4
aligning by index, items: 896
computing METEOR in parallel with 96 workers...
  0%|          | 0/896 [00:00<?, ?it/s]  0%|          | 1/896 [00:18<4:33:58, 18.37s/it]  0%|          | 4/896 [00:21<1:05:13,  4.39s/it]  1%|          | 7/896 [00:21<30:43,  2.07s/it]    1%|          | 9/896 [00:22<22:10,  1.50s/it]  2%|▏         | 16/896 [00:22<08:23,  1.75it/s]  4%|▎         | 32/896 [00:23<02:49,  5.10it/s]  7%|▋         | 59/896 [00:23<01:06, 12.58it/s]  8%|▊         | 75/896 [00:23<00:45, 18.20it/s]100%|██████████| 896/896 [00:23<00:00, 38.23it/s]
meteor	0.515435
computing BERTScore (roberta-large-mnli)...
found local BERTScore model at /nfs/gpu_trainee/final-project/models/bs_model/roberta-large-mnli
loading BERTScore model: /nfs/gpu_trainee/final-project/models/bs_model/roberta-large-mnli...
BERTScore device: GPU (2 device(s))
calculating scores...
computing bert embedding.
BERTScore:   0%|          | 0/896 [00:00<?, ?it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:15<00:46, 15.43s/it][A
 50%|█████     | 2/4 [00:16<00:13,  7.00s/it][A
 75%|███████▌  | 3/4 [00:17<00:04,  4.30s/it][A
100%|██████████| 4/4 [00:18<00:00,  3.01s/it][A100%|██████████| 4/4 [00:18<00:00,  4.66s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|█████     | 1/2 [00:00<00:00,  6.66it/s][A100%|██████████| 2/2 [00:00<00:00, 11.84it/s]
done in 18.83 seconds, 6.80 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  14%|█▍        | 128/896 [00:18<01:52,  6.80it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.07s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.07s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.07s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.03s/it][A100%|██████████| 4/4 [00:04<00:00,  1.05s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 55.32it/s]
done in 4.24 seconds, 30.20 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  29%|██▊       | 256/896 [00:23<00:51, 12.49it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.07s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.07s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.07s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.02s/it][A100%|██████████| 4/4 [00:04<00:00,  1.04s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.93it/s]
done in 4.20 seconds, 30.45 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  43%|████▎     | 384/896 [00:27<00:29, 17.10it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.07s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.07s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.07s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.05s/it][A100%|██████████| 4/4 [00:04<00:00,  1.05s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.92it/s]
done in 4.27 seconds, 29.97 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  57%|█████▋    | 512/896 [00:31<00:18, 20.59it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.05s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.05s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.01it/s][A100%|██████████| 4/4 [00:04<00:00,  1.01s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.37it/s]
done in 4.10 seconds, 31.24 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  71%|███████▏  | 640/896 [00:35<00:10, 23.47it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.05s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.05s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.04s/it][A100%|██████████| 4/4 [00:04<00:00,  1.04s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.58it/s]
done in 4.22 seconds, 30.35 sentences/sec
calculating scores...
computing bert embedding.
BERTScore:  86%|████████▌ | 768/896 [00:39<00:05, 25.43it/s]
  0%|          | 0/4 [00:00<?, ?it/s][A
 25%|██▌       | 1/4 [00:01<00:03,  1.05s/it][A
 50%|█████     | 2/4 [00:02<00:02,  1.05s/it][A
 75%|███████▌  | 3/4 [00:03<00:01,  1.05s/it][A
100%|██████████| 4/4 [00:04<00:00,  1.03s/it][A100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
computing greedy matching.

  0%|          | 0/2 [00:00<?, ?it/s][A100%|██████████| 2/2 [00:00<00:00, 54.45it/s]
BERTScore: 100%|██████████| 896/896 [00:44<00:00, 26.90it/s]BERTScore: 100%|██████████| 896/896 [00:44<00:00, 20.34it/s]
done in 4.19 seconds, 30.54 sentences/sec
bertscore_f1	0.977817
========== 

done.
items	896
meteor	0.515435
bertscore_f1	0.977817
