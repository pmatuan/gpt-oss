srun: job 82111 queued and waiting for resources
srun: job 82111 has been allocated resources
Device 0: AMD Instinct MI250X/MI250 | MultiProcessorCount=104 | MaxThreadsPerBlock=1024
Timing iterations: 100, warmup: 10

== MatMul QKV | Model 20B | B=896 ==
baseline (defines): 0.455548 ms | 58.0051 TFLOPS
  [discard] QKV_BM64_BN256_BK32_WM32_WN64 | 0.387905 ms | 68.12 TFLOPS | speedup x1.17438 | accuracy fail (max_abs=135, max_rel=6.4787e+06, l2_rel=0.997439)
  [faster] QKV_BM192_BN96_BK32_WM32_WN48 | 0.448101 ms | 58.9691 TFLOPS | speedup x1.01662
  [faster] QKV_BM192_BN128_BK32_WM32_WN64 | 0.451535 ms | 58.5206 TFLOPS | speedup x1.00889

== MatMul AttnOut | Model 20B | B=896 ==
baseline (defines): 0.551989 ms | 38.2966 TFLOPS
  [faster] ATT_BM64_BN64_BK32_WM32_WN32 | 0.528503 ms | 39.9984 TFLOPS | speedup x1.04444
  [discard] ATT_BM64_BN256_BK32_WM32_WN64 | 0.331804 ms | 63.7102 TFLOPS | speedup x1.6636 | accuracy fail (max_abs=156.5, max_rel=691843, l2_rel=0.989415)
  [faster] ATT_BM96_BN96_BK32_WM32_WN32 | 0.515225 ms | 41.0292 TFLOPS | speedup x1.07136
  [faster] ATT_BM96_BN160_BK32_WM32_WN32 | 0.550226 ms | 38.4193 TFLOPS | speedup x1.0032
  [faster] ATT_BM128_BN64_BK32_WM32_WN32 | 0.535204 ms | 39.4976 TFLOPS | speedup x1.03136
  [faster] ATT_BM160_BN96_BK32_WM32_WN32 | 0.551903 ms | 38.3026 TFLOPS | speedup x1.00016
  [faster] ATT_BM192_BN96_BK32_WM32_WN48 | 0.423965 ms | 49.8609 TFLOPS | speedup x1.30197

== MatMul Logits | Model 20B | B=896 ==
baseline (defines): 16.4163 ms | 63.218 TFLOPS
  [discard] LOGITS_BM64_BN256_BK32_WM32_WN64 | 13.5834 ms | 76.4028 TFLOPS | speedup x1.20856 | accuracy fail (max_abs=156.617, max_rel=1.78267e+07, l2_rel=0.99359)
  [faster] LOGITS_BM192_BN96_BK32_WM32_WN48 | 12.8992 ms | 80.4553 TFLOPS | speedup x1.27266
  [faster] LOGITS_BM192_BN128_BK32_WM32_WN64 | 16.3875 ms | 63.329 TFLOPS | speedup x1.00176
  [faster] LOGITS_BM256_BN64_BK32_WM32_WN32 | 13.7222 ms | 75.6298 TFLOPS | speedup x1.19633

== MatMul QKV | Model 120B | B=768 ==
baseline (defines): 0.44739 ms | 50.6252 TFLOPS
  [discard] QKV_BM64_BN256_BK32_WM32_WN64 | 0.382857 ms | 59.1585 TFLOPS | speedup x1.16856 | accuracy fail (max_abs=133.5, max_rel=1.35746e+06, l2_rel=0.996283)
  [faster] QKV_BM128_BN64_BK32_WM32_WN32 | 0.393865 ms | 57.505 TFLOPS | speedup x1.1359
  [faster] QKV_BM192_BN96_BK32_WM32_WN48 | 0.439444 ms | 51.5407 TFLOPS | speedup x1.01808
  [faster] QKV_BM192_BN128_BK32_WM32_WN64 | 0.443828 ms | 51.0315 TFLOPS | speedup x1.00803

== MatMul AttnOut | Model 120B | B=768 ==
baseline (defines): 0.564967 ms | 32.0716 TFLOPS
  [faster] ATT_BM64_BN64_BK32_WM32_WN32 | 0.458847 ms | 39.489 TFLOPS | speedup x1.23128
  [faster] ATT_BM64_BN128_BK32_WM32_WN32 | 0.395891 ms | 45.7686 TFLOPS | speedup x1.42708
  [discard] ATT_BM64_BN256_BK32_WM32_WN64 | 0.327265 ms | 55.3662 TFLOPS | speedup x1.72633 | accuracy fail (max_abs=160.5, max_rel=1.14929e+06, l2_rel=0.985107)
  [faster] ATT_BM96_BN96_BK32_WM32_WN32 | 0.517322 ms | 35.0253 TFLOPS | speedup x1.0921
  [faster] ATT_BM96_BN160_BK32_WM32_WN32 | 0.56236 ms | 32.2203 TFLOPS | speedup x1.00464
  [faster] ATT_BM128_BN64_BK32_WM32_WN32 | 0.366558 ms | 49.4312 TFLOPS | speedup x1.54128
  [faster] ATT_BM192_BN96_BK32_WM32_WN48 | 0.397426 ms | 45.5919 TFLOPS | speedup x1.42157
  [faster] ATT_BM192_BN128_BK32_WM32_WN64 | 0.317397 ms | 57.0875 TFLOPS | speedup x1.78
  [faster] ATT_BM224_BN96_BK32_WM32_WN48 | 0.544243 ms | 33.2929 TFLOPS | speedup x1.03808

== MatMul Logits | Model 120B | B=768 ==
baseline (defines): 13.494 ms | 65.922 TFLOPS
  [discard] LOGITS_BM64_BN256_BK32_WM32_WN64 | 11.6033 ms | 76.6637 TFLOPS | speedup x1.16294 | accuracy fail (max_abs=151.325, max_rel=1.18719e+08, l2_rel=0.992565)
  [faster] LOGITS_BM192_BN96_BK32_WM32_WN48 | 10.5766 ms | 84.1053 TFLOPS | speedup x1.27583
  [faster] LOGITS_BM192_BN128_BK32_WM32_WN64 | 13.4827 ms | 65.977 TFLOPS | speedup x1.00083
  [faster] LOGITS_BM256_BN64_BK32_WM32_WN32 | 10.8441 ms | 82.0308 TFLOPS | speedup x1.24436
